@page "/"
@inject IThemeService themeService
@inject IJSRuntime jsRuntime
@inject NavigationManager navigationManager
@inject SessionStorageService sessionStorageService
@inject BaseAuthenticationService authenticationService

<PageTitle>Aneejian | Click and Match</PageTitle>


@if (LoggedInUserId == 0)
{
	<_UserProfiles />
}
else
{
	<_Game />
}

@code {
	private int LoggedInUserId { get; set; }
	private bool LoginChecked { get; set; } = false;

	protected override void OnInitialized()
	{
		CheckLogin();
		authenticationService.OnChange += CheckLogin;
	}

	private async void CheckLogin()
	{
		LoginChecked = false;
		var stringId = await sessionStorageService.GetValueAsync<string>("profileId");
		if (!string.IsNullOrEmpty(stringId))
			LoggedInUserId = int.Parse(stringId);
		LoginChecked = true;
		StateHasChanged();
	}

	public void Dispose()
	{
		authenticationService.OnChange -= StateHasChanged;
	}
}